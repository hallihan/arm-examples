<html>

<head>
  <title>Sample Parameterized Azure ARM Deployment</title>
  <link crossorigin="anonymous" media="all" rel="stylesheet"
    href="https://github.githubassets.com/assets/frameworks-c674083190ce1d94f210f9171dd8b0a8.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet"
    href="https://github.githubassets.com/assets/github-056faeabc196106b48c8f7e009069446.css" />
  <style>
    div { padding: 10px 10px 10px 10px;}
  </style>
</head>

<body>
  <h1>Sample Parameterized Azure ARM Deployment</h1>
  <hr />
  <h4>This page will automatically construct a link to deploy the template at azuredeploy.json in the same location as
    the DEPLOY.html file. This is useful for deploying the template from a static website without having to edit the
    HTML.</h4>
  <a id="deploylink" href="#">
    <img
      src="https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.svg?sanitize=true"
      alt="Deploy to Azure Button"
      onclick="javascript:window.location.href='https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fhallihan%2Farm-examples%2Fmain%2Fazuredeploy.json'" />
  </a>
  <div>Clicking the button above will navigate to: <span id="deploylinklabel">If this text is still here, javascript is
      not working.</span></div>
  <hr />
  <div>The following script is used to construct the deployment link ([see source on GitHub](https://github.com/hallihan/arm-examples/blob/main/DEPLOY.html#L90-L97)):</div>
  <br />
  <div>
    <table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip>
      <tr>
        <td class="blob-num js-line-number" data-line-number="90"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-kos>&lt;</span><span
            class=pl-ent>script</span> <span class=pl-c1>lang</span>=&quot;<span class=pl-s>javascript</span>&quot;<span
            class=pl-kos>&gt;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="91"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-s1>newdeploylink</span> <span
            class=pl-c1>=</span> <span
            class=pl-s>&#39;https://portal.azure.com/#create/Microsoft.Template/uri/&#39;</span><span
            class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="92"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-s1>current</span> <span
            class=pl-c1>=</span> <span class=pl-smi>window</span><span class=pl-kos>.</span><span
            class=pl-c1>location</span><span class=pl-kos>.</span><span class=pl-c1>href</span><span
            class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="93"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-s1>templateuri</span> <span
            class=pl-c1>=</span> <span class=pl-s1>current</span><span class=pl-kos>.</span><span
            class=pl-en>substr</span><span class=pl-kos>(</span><span class=pl-c1>0</span><span class=pl-kos>,</span>
          <span class=pl-s1>current</span><span class=pl-kos>.</span><span class=pl-en>lastIndexOf</span><span
            class=pl-kos>(</span><span class=pl-s>&#39;/&#39;</span><span class=pl-kos>)</span><span
            class=pl-c1>+</span><span class=pl-c1>1</span><span class=pl-kos>)</span> <span class=pl-c1>+</span> <span
            class=pl-s>&#39;azuredeploy.json&#39;</span><span class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="94"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-s1>newdeploylink</span> <span
            class=pl-c1>+=</span> <span class=pl-en>encodeURI</span><span class=pl-kos>(</span><span
            class=pl-s1>templateuri</span><span class=pl-kos>)</span><span class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="95"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-smi>document</span><span
            class=pl-kos>.</span><span class=pl-en>getElementById</span><span class=pl-kos>(</span><span
            class=pl-s>&#39;deploylink&#39;</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span
            class=pl-c1>href</span><span class=pl-c1>=</span><span class=pl-s1>newdeploylink</span><span
            class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="96"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-smi>document</span><span
            class=pl-kos>.</span><span class=pl-en>getElementById</span><span class=pl-kos>(</span><span
            class=pl-s>&#39;deploylinklabel&#39;</span><span class=pl-kos>)</span><span class=pl-kos>.</span><span
            class=pl-c1>innerText</span><span class=pl-c1>=</span><span class=pl-s1>newdeploylink</span><span
            class=pl-kos>;</span></td>
      </tr>
      <tr>
        <td class="blob-num js-line-number" data-line-number="97"></td>
        <td class="blob-code blob-code-inner js-file-line"> <span class=pl-kos>&lt;/</span><span
            class=pl-ent>script</span><span class=pl-kos>&gt;</span></td>
      </tr>
    </table>
  </div>

  <script lang="javascript">
    newdeploylink = 'https://portal.azure.com/#create/Microsoft.Template/uri/';
    current = window.location.href;
    templateuri = current.substr(0, current.lastIndexOf('/') + 1) + 'azuredeploy.json';
    newdeploylink += encodeURIComponent(templateuri);
    document.getElementById('deploylink').href = newdeploylink;
    document.getElementById('deploylinklabel').innerText = newdeploylink;
  </script>
</body>

</html>